<div class="IndexPage">
  <section class="problematique">
    <div class="problematique-container">
      <h2>Recherche dans les données</h2>
    </div>
  </section>

  <div id="search" class="search-container">
    <div class="search-form">
      <div class="form-group table-selection">
        <label for="table-select">Sélectionner la table :</label>
        <select 
          id="table-select" 
          [(ngModel)]="selectedTable" 
          (change)="onTableChange($event)">
          <option *ngFor="let table of availableTables" [value]="table">{{table}}</option>
        </select>
      </div>

      <div class="search-lines">
        <app-search-line
          *ngFor="let line of searchLines; let i = index"
          [searchLineId]="line.id"
          [column]="line.column"
          [operator]="line.operator"
          [value]="line.value"
          [selectedTable]="selectedTable"
          [isFirst]="i === 0"
          [isLast]="i === searchLines.length - 1"
          (onAdd)="addSearchLine()"
          (onRemove)="removeSearchLine(i)"
          (onUpdate)="updateSearchLine(i, $event)">
        </app-search-line>
      </div>

      <div class="search-actions">
        <button (click)="addSearchLine()">Ajouter une ligne</button>
        <button 
          (click)="request()" 
          [disabled]="loading"
          class="submit-button search-button">
          {{ loading ? 'Recherche en cours...' : 'Rechercher' }}
        </button>
      </div>
    </div>

    <div class="results-section">
      <h3>Résultats</h3>
      <div *ngIf="searchResults.length === 0" class="no-results">
        Aucun résultat trouvé.
      </div>
      <div *ngIf="searchResults.length > 0">
        <app-resultats-page-recherche [results]="searchResults"></app-resultats-page-recherche>
      </div>
    </div>
  </div>

  <div class="horizontal-bar"></div>
</div>
